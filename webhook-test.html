<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webhook Test Server</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; }
        .webhook { background: #f5f5f5; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin: 10px 0; }
        .timestamp { color: #666; font-size: 0.8em; }
        .event-type { font-weight: bold; color: #2196F3; }
        pre { background: #f9f9f9; padding: 10px; border-radius: 3px; overflow-x: auto; }
        .status { padding: 2px 8px; border-radius: 3px; color: white; font-size: 0.8em; }
        .success { background: #4CAF50; }
        .error { background: #f44336; }
    </style>
</head>
<body>
    <h1>üîó Webhook Test Server</h1>
    <p>–≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å webhook'–∏ –æ—Ç —Å–∏—Å—Ç–µ–º—ã –¶–≤–µ—Ç–æ–∫—Ä–∞—Ñ—Ç.</p>
    
    <div id="status">
        <h3>–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞: <span class="status success">–ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É webhook'–æ–≤</span></h3>
        <p><strong>–¢–µ—Å—Ç–æ–≤—ã–π URL:</strong> https://webhook.site/#!/your-unique-id</p>
        <p><strong>–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:</strong> python -m http.server 8080</p>
    </div>

    <div id="instructions">
        <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ</h2>
        
        <h3>1. –°–æ–∑–¥–∞–Ω–∏–µ webhook'–∞ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏</h3>
        <ol>
            <li>–í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¶–≤–µ—Ç–æ–∫—Ä–∞—Ñ—Ç</li>
            <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Webhook'–∏"</li>
            <li>–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å Webhook"</li>
            <li>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
                <ul>
                    <li><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> –¢–µ—Å—Ç–æ–≤—ã–π webhook</li>
                    <li><strong>URL:</strong> https://webhook.site/#!/your-unique-id</li>
                    <li><strong>–°–æ–±—ã—Ç–∏—è:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</li>
                    <li><strong>–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:</strong> my-secret-key (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</li>
                </ul>
            </li>
        </ol>

        <h3>2. –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</h3>
        <ul>
            <li><code>callback.created</code> - –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã–π –∑–≤–æ–Ω–æ–∫</li>
            <li><code>callback.updated</code> - –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏–∑–º–µ–Ω–µ–Ω</li>
            <li><code>blog.post_created</code> - –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Å—Ç–∞—Ç—å—è</li>
            <li><code>blog.post_published</code> - –°—Ç–∞—Ç—å—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞</li>
            <li><code>portfolio.item_created</code> - –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞</li>
            <li><code>sale.created</code> - –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞</li>
            <li><code>customer.created</code> - –ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç</li>
            <li><code>product.created</code> - –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä</li>
        </ul>

        <h3>3. –§–æ—Ä–º–∞—Ç webhook payload</h3>
        <pre>{
  "eventType": "callback.created",
  "data": {
    "id": 123,
    "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
    "phone": "+7 (900) 123-45-67",
    "message": "–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å –±—É–∫–µ—Ç",
    "callTime": "–∑–∞–≤—Ç—Ä–∞ —É—Ç—Ä–æ–º",
    "createdAt": "2025-01-23T10:00:00Z"
  },
  "timestamp": "2025-01-23T10:00:00Z",
  "source": "tsvetokraft-website"
}</pre>

        <h3>4. –ó–∞–≥–æ–ª–æ–≤–∫–∏ webhook'–∞</h3>
        <ul>
            <li><code>Content-Type: application/json</code></li>
            <li><code>User-Agent: Tsvetokraft-Webhook/1.0</code></li>
            <li><code>X-Webhook-Event: callback.created</code></li>
            <li><code>X-Webhook-Timestamp: 2025-01-23T10:00:00Z</code></li>
            <li><code>X-Webhook-Signature: sha256=...</code> (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)</li>
        </ul>

        <h3>5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)</h3>
        <pre>// Node.js –ø—Ä–∏–º–µ—Ä
const crypto = require('crypto');

function verifyWebhookSignature(payload, signature, secret) {
  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(payload)
    .digest('hex');
  
  return signature === `sha256=${expectedSignature}`;
}</pre>
    </div>

    <div id="examples">
        <h2>üîß –ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</h2>
        
        <h3>PHP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫</h3>
        <pre>&lt;?php
$payload = file_get_contents('php://input');
$data = json_decode($payload, true);

if ($data['eventType'] === 'callback.created') {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    $subject = "–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞: " . $data['data']['name'];
    $message = "–¢–µ–ª–µ—Ñ–æ–Ω: " . $data['data']['phone'] . "\n";
    $message .= "–°–æ–æ–±—â–µ–Ω–∏–µ: " . $data['data']['message'];
    
    mail('admin@example.com', $subject, $message);
}

http_response_code(200);
echo json_encode(['status' => 'ok']);
?&gt;</pre>

        <h3>Python –æ–±—Ä–∞–±–æ—Ç—á–∏–∫</h3>
        <pre>from flask import Flask, request, jsonify
import smtplib
from email.mime.text import MIMEText

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def handle_webhook():
    data = request.json
    
    if data['eventType'] == 'sale.created':
        # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
        send_telegram_message(f"üí∞ –ù–æ–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –Ω–∞ {data['data']['totalAmount']} —Ä—É–±!")
    
    return jsonify({'status': 'ok'})

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080)</pre>

        <h3>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n</h3>
        <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Webhook —É–∑–µ–ª n8n —Å URL: <code>https://your-n8n.com/webhook/webhook-id</code></p>
        <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –¥–ª—è:</p>
        <ul>
            <li>–û—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Slack/Discord</li>
            <li>–°–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –≤ Trello/Notion</li>
            <li>–û—Ç–ø—Ä–∞–≤–∫–∏ SMS —á–µ—Ä–µ–∑ Twilio</li>
            <li>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å CRM —Å–∏—Å—Ç–µ–º–∞–º–∏</li>
        </ul>
    </div>

    <div id="recent-webhooks">
        <h2>üì® –ü–æ—Å–ª–µ–¥–Ω–∏–µ webhook'–∏</h2>
        <div id="webhook-list">
            <p>Webhook'–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å –ø—Ä–∏ –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏–∏...</p>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–æ–π JavaScript –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è webhook'–æ–≤ (–µ—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä)
        function displayWebhook(webhook) {
            const webhookList = document.getElementById('webhook-list');
            const webhookDiv = document.createElement('div');
            webhookDiv.className = 'webhook';
            
            webhookDiv.innerHTML = `
                <div class="timestamp">${new Date().toLocaleString('ru-RU')}</div>
                <div class="event-type">${webhook.eventType || 'test-event'}</div>
                <pre>${JSON.stringify(webhook, null, 2)}</pre>
            `;
            
            webhookList.insertBefore(webhookDiv, webhookList.firstChild);
        }

        // –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        setTimeout(() => {
            displayWebhook({
                eventType: 'callback.created',
                data: {
                    id: 1,
                    name: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞',
                    phone: '+7 (900) 123-45-67',
                    message: '–ò–Ω—Ç–µ—Ä–µ—Å—É—é—Ç —Å–≤–∞–¥–µ–±–Ω—ã–µ –±—É–∫–µ—Ç—ã'
                },
                timestamp: new Date().toISOString(),
                source: 'tsvetokraft-website'
            });
        }, 2000);
    </script>
</body>
</html>